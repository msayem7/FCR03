{"version":3,"file":"js/78.b9d34800.js","mappings":"sQAiBE,MAAMA,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,IAAI,MAEbC,EAAaC,UACjB,MAAM,KAAEC,SAAeC,EAAAA,EAAMC,IAAI,aAAaR,EAAMS,OAAOC,YAC3DR,EAAOS,MAAQL,CAAI,EAGfM,EAAeP,UACnB,UACQE,EAAAA,EAAMM,IAAI,aAAaX,EAAOS,MAAMG,YAAaC,EAEzD,CAAE,MAAOC,GACHA,EAAMC,UAAUX,MAAMY,UACxBC,MAAMH,EAAMC,SAASX,KAAKY,eACpBd,IAEV,G,OAGFgB,EAAAA,EAAAA,IAAUhB,G,uNClCZ,MAAMiB,EAAc,EAEpB,O,0YC6CA,MAAMrB,GAAQC,EAAAA,EAAAA,MACRqB,GAASC,EAAAA,EAAAA,MAETC,GAAYC,EAAAA,EAAAA,KAAS,IAAMzB,EAAM0B,KAAKC,SAAS,YAC/CC,EAAgB,CAAE,EAAG,cAAe,EAAG,UAEvCb,GAAWZ,EAAAA,EAAAA,IAAI,CACnB0B,KAAM,GACNC,YAAa,EACbC,OAAQ,KACRC,QAAS,GACTC,QAAS,GACTf,QAAS,IAGLgB,GAAW/B,EAAAA,EAAAA,IAAI,IAEfgC,GAAmBV,EAAAA,EAAAA,KAAS,IACzBS,EAASvB,MAAMyB,QAAOC,GAAKA,EAAEvB,WAAad,EAAMS,OAAOC,YAG1D4B,EAAejC,UACnB,IACE,MAAM,KAAEC,SAAeC,EAAAA,EAAMC,IAAI,cACjC0B,EAASvB,MAAQL,CACnB,CAAE,MAAOU,GACPuB,QAAQvB,MAAM,0BAA2BA,EAC3C,GAGIwB,EAAenC,UACnB,IACE,MAAMoC,EAAU,IACX1B,EAASJ,MACZO,QAASH,EAASJ,MAAMO,SAGtBM,EAAUb,YACNJ,EAAAA,EAAMM,IAAI,aAAab,EAAMS,OAAOC,WAAY+B,SAEhDlC,EAAAA,EAAMmC,KAAK,aAAcD,GAEjCnB,EAAOqB,KAAK,YAEd,CAAE,MAAO3B,GACwB,MAA3BA,EAAMC,UAAU2B,SAClBzB,MAAM,6DACAmB,IAEV,G,OAGFlB,EAAAA,EAAAA,KAAUf,UAER,SADMiC,IACFd,EAAUb,MAAO,CACnB,MAAM,KAAEL,SAAeC,EAAAA,EAAMC,IAAI,aAAaR,EAAMS,OAAOC,YAC3DK,EAASJ,MAAQL,CACnB,K,kyCCxGF,MAAMe,EAAc,EAEpB,O","sources":["webpack://crf03/./src/views/BranchEditView.vue","webpack://crf03/./src/views/BranchEditView.vue?9ca0","webpack://crf03/./src/views/BranchFormView.vue","webpack://crf03/./src/views/BranchFormView.vue?56ef"],"sourcesContent":["<template>\r\n    <div v-if=\"branch\">\r\n      <h2>Edit Branch</h2>\r\n      <BranchFormView\r\n        :initial-data=\"branch\" \r\n        :is-editing=\"true\" \r\n        @submit=\"handleUpdate\"\r\n      />\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, onMounted } from 'vue'\r\n  import { useRoute } from 'vue-router'\r\n  import axios from '@/plugins/axios'\r\n  import BranchFormView from '@/views/BranchFormView.vue'\r\n  \r\n  const route = useRoute()\r\n  const branch = ref(null)\r\n  \r\n  const loadBranch = async () => {\r\n    const { data } = await axios.get(`/branches/${route.params.aliasId}/`)\r\n    branch.value = data\r\n  }\r\n  \r\n  const handleUpdate = async (formData) => {\r\n    try {\r\n      await axios.put(`/branches/${branch.value.alias_id}/`, formData)\r\n      // Handle success (redirect or show message)\r\n    } catch (error) {\r\n      if (error.response?.data?.version) {\r\n        alert(error.response.data.version)\r\n        await loadBranch() // Refresh data\r\n      }\r\n    }\r\n  }\r\n  \r\n  onMounted(loadBranch)\r\n  </script>","import script from \"./BranchEditView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./BranchEditView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n  <div class=\"container mt-4\">\r\n    <h2>{{ isEditing ? 'Edit' : 'Create' }} Branch</h2>\r\n    \r\n    <form @submit.prevent=\"handleSubmit\">\r\n      <div class=\"row g-3\">\r\n        <div class=\"col-md-6\">\r\n          <label class=\"form-label\">Branch Name</label>\r\n          <input v-model=\"formData.name\" type=\"text\" class=\"form-control\" required>\r\n        </div>\r\n\r\n        <div class=\"col-md-6\">\r\n          <label class=\"form-label\">Branch Type</label>\r\n          <select v-model=\"formData.branch_type\" class=\"form-select\" required>\r\n            <option v-for=\"(label, value) in branchTypeMap\" \r\n                    :key=\"value\" \r\n                    :value=\"value\">\r\n              {{ label }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"col-12\">\r\n          <label class=\"form-label\">Parent Branch</label>\r\n          <select v-model=\"formData.parent\" class=\"form-select\">\r\n            <option :value=\"null\">No Parent</option>\r\n            <option v-for=\"branch in availableParents\" \r\n                    :key=\"branch.alias_id\" \r\n                    :value=\"branch.alias_id\">\r\n              {{ branch.name }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n        <!-- Add address and contact fields -->\r\n        <div class=\"col-12\">\r\n          <button type=\"submit\" class=\"btn btn-primary\">\r\n            {{ isEditing ? 'Update' : 'Create' }} Branch\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport axios from '@/plugins/axios'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst isEditing = computed(() => route.path.includes('/edit/'))\r\nconst branchTypeMap = { 1: 'Head Office', 2: 'Branch' }\r\n\r\nconst formData = ref({\r\n  name: '',\r\n  branch_type: 2,\r\n  parent: null,\r\n  address: '',\r\n  contact: '',\r\n  version: 1\r\n})\r\n\r\nconst branches = ref([])\r\n\r\nconst availableParents = computed(() => {\r\n  return branches.value.filter(b => b.alias_id !== route.params.aliasId)\r\n})\r\n\r\nconst loadBranches = async () => {\r\n  try {\r\n    const { data } = await axios.get('/branches/')\r\n    branches.value = data\r\n  } catch (error) {\r\n    console.error('Error loading branches:', error)\r\n  }\r\n}\r\n\r\nconst handleSubmit = async () => {\r\n  try {\r\n    const payload = {\r\n      ...formData.value,\r\n      version: formData.value.version // Make sure to send current version\r\n    }\r\n    \r\n    if (isEditing.value) {\r\n      await axios.put(`/branches/${route.params.aliasId}/`, payload)\r\n    } else {\r\n      await axios.post('/branches/', payload)\r\n    }\r\n    router.push('/branches')\r\n\r\n  } catch (error) {\r\n    if (error.response?.status === 409) {\r\n      alert('Concurrency conflict. Please refresh and try again.')\r\n      await loadBranches() // Refresh data\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  await loadBranches()\r\n  if (isEditing.value) {\r\n    const { data } = await axios.get(`/branches/${route.params.aliasId}/`)\r\n    formData.value = data\r\n  }\r\n})\r\n</script>","import script from \"./BranchFormView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./BranchFormView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["route","useRoute","branch","ref","loadBranch","async","data","axios","get","params","aliasId","value","handleUpdate","put","alias_id","formData","error","response","version","alert","onMounted","__exports__","router","useRouter","isEditing","computed","path","includes","branchTypeMap","name","branch_type","parent","address","contact","branches","availableParents","filter","b","loadBranches","console","handleSubmit","payload","post","push","status"],"sourceRoot":""}