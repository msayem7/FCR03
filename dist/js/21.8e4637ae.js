"use strict";(self["webpackChunkcrf03"]=self["webpackChunkcrf03"]||[]).push([[21],{1021:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var l=a(6768),n=a(5130),s=a(4232),r=a(144),o=a(5875),c=a(8082);const u={class:"container mt-4"},i={class:"d-flex justify-content-between align-items-center mb-4"},d={class:"card mb-4"},v={class:"card-body"},m={class:"row g-3"},k={class:"col-md-3"},L={class:"col-md-3"},_={class:"col-md-4"},b=["value"],h={class:"table-responsive"},p={class:"table table-striped table-hover"},f={key:0};var g={__name:"CreditInvoiceList",setup(e){const t=(0,o.x)(),a=(0,r.KR)([]),g=(0,r.KR)([]),y=(0,r.KR)({dateFrom:"",dateTo:"",customer:""}),C=async()=>{try{if(!t.selectedBranch)throw a.value=[],new Error("Select a branch first");const e={branch:t.selectedBranch,transaction_date_after:y.value.dateFrom,transaction_date_before:y.value.dateTo,customer:y.value.customer},{data:l}=await c.A.get("/credit-invoices/",{params:e});a.value=l}catch(e){console.error("Fetch error:",e),alert("Credit Invoice: "+e.message)}},w=async()=>{try{const e={is_active:!0,branch:t.selectedBranch},{data:a}=await c.A.get("/customers/",{params:e});g.value=a}catch(e){console.error("Error loading customers: ",e),alert("Error loading customers: "+e.message)}},I=e=>{if(!e.transaction_date)return"";const t=new Date(e.transaction_date);return e.graceDays&&t.setDate(t.getDate()+parseInt(e.payment_grace_days)),t.toISOString().split("T")[0]};return(0,l.sV)((()=>{w(),C()})),(0,l.wB)([()=>t.selectedBranch],(()=>{C(),w()}),{immediate:!0}),(0,l.wB)([()=>t.refreshTrigger],(()=>{C(),w()}),{immediate:!0}),(e,t)=>{const r=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",i,[t[4]||(t[4]=(0,l.Lk)("h2",null,"Credit Invoices",-1)),(0,l.bF)(r,{to:"/credit-invoices/create",class:"btn btn-success"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)(" Create New ")]))),_:1})]),(0,l.Lk)("div",d,[(0,l.Lk)("div",v,[(0,l.Lk)("div",m,[(0,l.Lk)("div",k,[(0,l.bo)((0,l.Lk)("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>y.value.dateFrom=e),class:"form-control"},null,512),[[n.Jo,y.value.dateFrom]])]),(0,l.Lk)("div",L,[(0,l.bo)((0,l.Lk)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>y.value.dateTo=e),class:"form-control"},null,512),[[n.Jo,y.value.dateTo]])]),(0,l.Lk)("div",_,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>y.value.customer=e),class:"form-select"},[t[5]||(t[5]=(0,l.Lk)("option",{value:""},"All Customers",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(g.value,(e=>((0,l.uX)(),(0,l.CE)("option",{value:e.alias_id,key:e.alias_Id},(0,s.v_)(e.name),9,b)))),128))],512),[[n.u1,y.value.customer]])]),(0,l.Lk)("div",{class:"col-md-2"},[(0,l.Lk)("button",{onClick:C,class:"btn btn-primary w-100"},"Filter")])])])]),(0,l.Lk)("div",h,[(0,l.Lk)("table",p,[t[8]||(t[8]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"Invoice No"),(0,l.Lk)("th",null,"Customer"),(0,l.Lk)("th",null,"Invoice Date"),(0,l.Lk)("th",null,"Payment Date"),(0,l.Lk)("th",null,"Amount"),(0,l.Lk)("th",null,"Actions")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.value,((e,n)=>((0,l.uX)(),(0,l.CE)("tr",{key:e.alias_id},[(0,l.Lk)("td",null,(0,s.v_)(e.invoice_no)+" ("+(0,s.v_)(n+1)+"/"+(0,s.v_)(a.value.length)+")",1),(0,l.Lk)("td",null,(0,s.v_)(e.customer_name),1),(0,l.Lk)("td",null,(0,s.v_)(new Date(e.transaction_date).toLocaleDateString()),1),(0,l.Lk)("td",null,(0,s.v_)(I(e)),1),(0,l.Lk)("td",null,(0,s.v_)(e.due_amount),1),(0,l.Lk)("td",null,[(0,l.bF)(r,{to:{name:"CreditInvoiceEdit",params:{aliasId:e.alias_id}},class:"btn btn-sm btn-warning"},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)(" Edit ")]))),_:2},1032,["to"])])])))),128)),0===a.value.length?((0,l.uX)(),(0,l.CE)("tr",f,t[7]||(t[7]=[(0,l.Lk)("td",{colspan:"6",class:"text-center"},"No invoices found",-1)]))):(0,l.Q3)("",!0)])])])])}}},y=a(1241);const C=(0,y.A)(g,[["__scopeId","data-v-38ece361"]]);var w=C}}]);
//# sourceMappingURL=21.8e4637ae.js.map